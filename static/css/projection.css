/* Projeção PRO */

.projection-page{
  display: grid;
  gap: 18px;
}

.projection-page .panel{
  border-radius: 18px;
  border-color: var(--border);
}

.projection-hero{
  position: relative;
  overflow: visible;
}

.projection-hero::before{
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background:
    radial-gradient(600px 200px at 0% 0%, rgba(76,175,80,0.18), transparent 65%),
    radial-gradient(420px 220px at 100% 0%, rgba(158,228,159,0.14), transparent 70%);
  opacity: 0.85;
  pointer-events: none;
}

.hero-title{
  display: grid;
  gap: 6px;
  position: relative;
  z-index: 1;
}

.projection-hero .panel-head,
.projection-hero .projection-controls{
  position: relative;
  z-index: 1;
}

.hero-meta{
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 10px;
  margin-bottom: 2px;
}

.pro-pill{
  background: rgba(76,175,80,0.18);
  border-color: rgba(76,175,80,0.4);
  color: #fff;
}

.hero-status{
  font-size: 12px;
  font-weight: 850;
  color: var(--text-muted);
}

.hero-status.is-dirty{
  color: var(--warning);
}

.projection-controls{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 14px;
  margin-top: 12px;
}

.projection-hero .panel-head{
  align-items: center;
  gap: 16px;
}

.projection-presets{
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
  align-items: center;
}

.projection-page .select{
  position: relative;
  width: 100%;
}

.projection-page .select-native{
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 0;
  height: 0;
  display: none;
}

.projection-page .select select{
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 0;
  height: 0;
}

.projection-page .select-trigger{
  text-align: left;
  padding-right: 34px;
  position: relative;
}

.projection-page .select-trigger::after{
  content: "";
  position: absolute;
  right: 12px;
  top: 50%;
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 6px solid var(--text-muted);
  transform: translateY(-40%);
  pointer-events: none;
}

.projection-page .select-options{
  position: absolute;
  left: 0;
  right: 0;
  top: calc(100% + 6px);
  z-index: 30;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--overlay);
  box-shadow: var(--shadow);
  padding: 6px;
  display: none;
  max-height: 240px;
  overflow-y: auto;
}

.projection-page .select.open .select-options{
  display: block;
}

.projection-page .select-option{
  width: 100%;
  text-align: left;
  border: 0;
  background: transparent;
  color: var(--text);
  padding: 8px 10px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 13px;
}

.projection-page .select-option:hover,
.projection-page .select-option.is-selected{
  background: var(--surface-2);
  color: var(--heading);
}

.projection-page .select.is-disabled .select-trigger{
  opacity: 0.6;
  cursor: not-allowed;
}

.projection-controls select,
.projection-controls input[type="date"],
.projection-controls input[type="number"],
.projection-controls input[type="text"]{
  width: 100%;
}

.projection-toggle .toggle-row{
  display:flex;
  gap: 10px;
  align-items: center;
  padding: 10px 12px;
  border: 1px solid var(--border);
  background: var(--surface-2);
  border-radius: 14px;
}

.projection-toggle{
  grid-column: 1 / -1;
}

.projection-toggle input[type="checkbox"]{
  width: 18px;
  height: 18px;
}

.toggle-hint{
  color: var(--text-muted);
  font-weight: 800;
  font-size: 12px;
}

.projection-scenario{
  grid-column: 1 / -1;
}

.scenario-row{
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
}

.scenario-row select{
  min-width: 220px;
  flex: 1 1 260px;
}

.scenario-row .btn-secondary{
  flex: 0 0 auto;
  white-space: nowrap;
}

.scenario-note{
  margin: 0;
  color: var(--text-muted);
  font-weight: 800;
  font-size: 12px;
}

.scenario-footer{
  margin-top: 6px;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.scenario-state{
  color: var(--text);
  font-weight: 900;
  font-size: 12px;
}

.scenario-state.is-dirty{
  color: var(--warning);
}

.btn-secondary.danger{
  border-color: rgba(244,67,54,0.65);
  color: var(--danger);
}
.btn-secondary.danger:hover{
  background: rgba(244,67,54,0.18);
}

.projection-grid{
  display: grid;
  gap: 18px;
  grid-template-columns: repeat(12, minmax(0, 1fr));
  align-items: start;
}

.projection-kpis{
  grid-column: 1 / -1;
}

.projection-grid > .projection-kpis,
.projection-grid > .projection-timeline{
  grid-column: 1 / -1;
}

.projection-grid > .projection-calendar{
  grid-column: span 8;
}

.projection-grid > .projection-coverage{
  grid-column: span 4;
}

.projection-grid > .projection-risk,
.projection-grid > .projection-overrides,
.projection-grid > .projection-simulators{
  grid-column: span 4;
}

.kpi-grid{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
}

.kpi-card{
  border: 1px solid var(--border);
  background: linear-gradient(180deg, var(--surface), var(--surface-2));
  border-radius: 16px;
  padding: 10px 12px;
  display: grid;
  gap: 4px;
  min-width: 0;
  position: relative;
}

.kpi-card::before{
  content: "";
  position: absolute;
  left: 0;
  top: 10px;
  bottom: 10px;
  width: 4px;
  border-radius: 999px;
  background: rgba(76,175,80,0.8);
  opacity: 0.55;
}

.kpi-card.is-negative::before{
  background: rgba(244,67,54,0.8);
  opacity: 0.7;
}

.kpi-label{
  color: var(--text-muted);
  font-weight: 950;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.kpi-value{
  font-size: 22px;
  letter-spacing: -0.02em;
}

.kpi-meta{
  color: var(--text-muted);
  font-weight: 850;
  font-size: 12px;
}

.projection-timeline .panel-actions{
  display:flex;
  align-items:center;
  flex-wrap: nowrap;
  white-space: nowrap;
}

.projection-timeline{
  position: relative;
  isolation: isolate;
}

.projection-timeline .panel-head{
  position: relative;
  z-index: 2;
}

.projection-balance{
  color: var(--text);
  font-weight: 950;
}

.timeline-chart{
  position: relative;
  border: 1px solid var(--border);
  background: var(--surface-2);
  border-radius: 18px;
  padding: 10px;
  margin-top: 10px;
  overflow: hidden;
}

.timeline-svg{
  width: 100%;
  height: 240px;
  display: block;
}

.timeline-path{
  fill: none;
  stroke: rgba(76,175,80,0.95);
  stroke-width: 3;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.timeline-path.is-negative{
  stroke: rgba(244,67,54,0.95);
}

.timeline-area{
  fill: rgba(76,175,80,0.14);
}

.timeline-area.is-negative{
  fill: rgba(244,67,54,0.16);
}

.timeline-zero{
  stroke: var(--divider);
  stroke-dasharray: 4 6;
}

.timeline-reserve{
  stroke: rgba(255,193,7,0.85);
  stroke-dasharray: 2 6;
}

.timeline-axis{
  stroke: var(--divider);
  stroke-width: 2;
}

.timeline-empty{
  position:absolute;
  inset: 0;
  display:none;
  align-items:center;
  justify-content:center;
  color: var(--text-muted);
  font-weight: 950;
}

.timeline-legend{
  margin-top: 10px;
  display: flex;
  flex-wrap: nowrap;
  gap: 12px;
  font-size: 12px;
  font-weight: 850;
  color: var(--text-muted);
  overflow-x: auto;
  scrollbar-width: thin;
}

.timeline-legend span{
  white-space: nowrap;
}

.timeline-legend::-webkit-scrollbar{
  height: 6px;
}

.timeline-legend::-webkit-scrollbar-thumb{
  background: var(--border);
  border-radius: 999px;
}

.legend-dot{
  display: inline-flex;
  width: 10px;
  height: 10px;
  border-radius: 999px;
  margin-right: 6px;
}

.dot-line{ background: rgba(76,175,80,0.95); }
.dot-zero{ background: var(--divider); }
.dot-reserve{ background: rgba(255,193,7,0.95); }

.timeline-table-wrap{
  margin-top: 12px;
  overflow: auto;
  border: 1px solid var(--border);
  border-radius: 18px;
}

.timeline-table{
  width: 100%;
  border-collapse: collapse;
  min-width: 980px;
}

.timeline-table thead th{
  position: sticky;
  top: 0;
  background: var(--table-head-bg);
  color: var(--text-muted);
  font-weight: 950;
  font-size: 12px;
  text-align: left;
  padding: 10px 12px;
  border-bottom: 1px solid var(--divider);
}

.timeline-table thead th:nth-child(5),
.timeline-table thead th:nth-child(6){
  text-align: right;
}

.timeline-table tbody td{
  padding: 10px 12px;
  border-bottom: 1px solid var(--divider);
  color: var(--text);
  font-weight: 800;
  font-size: 13px;
  vertical-align: top;
  white-space: nowrap;
}

.timeline-table tbody tr:nth-child(even){
  background: var(--table-bg);
}

.timeline-table .num{
  text-align: right;
}

.timeline-table tbody td:nth-child(2){
  white-space: normal;
  max-width: 260px;
}

.timeline-table tbody tr:hover{
  background: var(--table-row-hover);
}

.timeline-table tbody tr.is-uncovered{
  background: rgba(244,67,54,0.08);
}

.timeline-table td.is-negative{
  color: var(--danger);
}

.badge{
  position: static;
  top: auto;
  right: auto;
  bottom: auto;
  left: auto;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid var(--chip-border);
  background: var(--chip-bg);
  color: var(--chip-text);
  font-weight: 950;
  font-size: 12px;
}

.badge.type-income{ border-color: rgba(76,175,80,0.6); }
.badge.type-expense{ border-color: rgba(244,67,54,0.6); }

.badge.cover-yes{ border-color: rgba(76,175,80,0.75); background: rgba(76,175,80,0.12); }
.badge.cover-no{ border-color: rgba(244,67,54,0.75); background: rgba(244,67,54,0.14); }

.badge.status{
  border-color: var(--chip-border);
  background: var(--chip-bg);
  font-size: 11px;
}

.badge.status-paid{
  border-color: rgba(76,175,80,0.65);
  background: rgba(76,175,80,0.16);
}

.badge.status-pending{
  border-color: rgba(255,193,7,0.6);
  background: rgba(255,193,7,0.16);
}

.badge.status-forecast{
  border-color: rgba(99,102,241,0.55);
  background: rgba(99,102,241,0.14);
}

.badge.status-negative{
  color: var(--danger);
}

.badge.priority{
  cursor: pointer;
}
.badge.priority.alta{ border-color: rgba(244,67,54,0.7); }
.badge.priority.media{ border-color: rgba(255,193,7,0.7); }
.badge.priority.baixa{ border-color: rgba(33,150,243,0.7); }

.row-actions{
  display:flex;
  gap: 8px;
  flex-wrap: nowrap;
  align-items: center;
  white-space: nowrap;
}

.row-actions button{
  white-space: nowrap;
  height: 34px;
  padding: 0 10px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text);
  font-weight: 950;
  cursor: pointer;
}
.row-actions button:hover{ background: var(--surface); }

.timeline-table tbody td:last-child,
.timeline-table thead th:last-child{
  min-width: 140px;
  white-space: nowrap;
}

.risk-list{
  display:grid;
  gap: 12px;
  margin-top: 10px;
}

.risk-item{
  border: 1px solid var(--border);
  background: var(--surface-2);
  border-radius: 16px;
  padding: 12px 14px;
}

.risk-item strong{
  display:block;
  margin-bottom: 6px;
}

.risk-sub{
  color: var(--text-muted);
  font-weight: 850;
  font-size: 12px;
}

.risk-mini{
  margin-top: 8px;
  display:grid;
  gap: 6px;
}

.risk-mini .mini{
  display:flex;
  justify-content: space-between;
  gap: 10px;
  color: var(--text);
  font-weight: 850;
  font-size: 12px;
}

.projection-calendar .panel-actions{
  align-items: center;
}

.projection-calendar,
.projection-coverage{
  display: flex;
  flex-direction: column;
  min-height: 360px;
}

.calendar-grid-wrap{
  flex: 1;
}

.coverage-grid{
  flex: 1;
}

.calendar-range{
  color: var(--text-muted);
  font-weight: 900;
  font-size: 12px;
}

.calendar-grid-wrap{
  position: relative;
  margin-top: 10px;
}

.calendar-weekdays{
  display:grid;
  grid-template-columns: repeat(7, minmax(0, 1fr));
  gap: 6px;
  font-size: 10px;
  font-weight: 900;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-muted);
}

.calendar-grid{
  margin-top: 8px;
  display:grid;
  grid-template-columns: repeat(7, minmax(0, 1fr));
  gap: 6px;
}

.calendar-cell{
  height: 26px;
  border-radius: 7px;
  border: 1px solid var(--divider);
  background: var(--surface-2);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: 11px;
  font-weight: 900;
  color: var(--text);
}

.calendar-cell.is-empty{
  border-color: transparent;
  background: transparent;
  color: transparent;
}

.calendar-cell.neutral{
  color: var(--text-muted);
}

.calendar-cell.pos-1{ background: rgba(76,175,80,0.14); border-color: rgba(76,175,80,0.2); }
.calendar-cell.pos-2{ background: rgba(76,175,80,0.22); border-color: rgba(76,175,80,0.3); }
.calendar-cell.pos-3{ background: rgba(76,175,80,0.32); border-color: rgba(76,175,80,0.4); color: #fff; }
.calendar-cell.pos-4{ background: rgba(76,175,80,0.5); border-color: rgba(76,175,80,0.6); color: #fff; }

.calendar-cell.neg-1{ background: rgba(244,67,54,0.14); border-color: rgba(244,67,54,0.22); }
.calendar-cell.neg-2{ background: rgba(244,67,54,0.24); border-color: rgba(244,67,54,0.32); color: #fff; }
.calendar-cell.neg-3{ background: rgba(244,67,54,0.36); border-color: rgba(244,67,54,0.46); color: #fff; }
.calendar-cell.neg-4{ background: rgba(244,67,54,0.52); border-color: rgba(244,67,54,0.62); color: #fff; }

.calendar-empty{
  position: absolute;
  inset: 34px 0 0;
  display:none;
  align-items:center;
  justify-content:center;
  color: var(--text-muted);
  font-weight: 950;
}

.calendar-summary{
  margin-top: 12px;
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 10px;
}

.summary-item{
  border: 1px solid var(--border);
  background: var(--surface-2);
  border-radius: 14px;
  padding: 10px 12px;
  display:grid;
  gap: 4px;
  font-size: 12px;
  font-weight: 900;
  color: var(--text-muted);
}

.summary-item strong{
  color: var(--text);
  font-size: 14px;
}

.calendar-legend{
  margin-top: 10px;
  display:flex;
  gap: 12px;
  flex-wrap: wrap;
  font-size: 12px;
  font-weight: 850;
  color: var(--text-muted);
}

.legend-box{
  width: 12px;
  height: 12px;
  border-radius: 4px;
  display: inline-flex;
  margin-right: 6px;
}

.legend-box.pos{
  background: rgba(76,175,80,0.5);
  border: 1px solid rgba(76,175,80,0.6);
}

.legend-box.neg{
  background: rgba(244,67,54,0.5);
  border: 1px solid rgba(244,67,54,0.6);
}

.coverage-grid{
  display:grid;
  gap: 12px;
  margin-top: 8px;
}

.coverage-item{
  border: 1px solid var(--border);
  background: var(--surface-2);
  border-radius: 16px;
  padding: 10px 12px;
  display:grid;
  gap: 8px;
}

.coverage-row{
  display:flex;
  justify-content: space-between;
  align-items: baseline;
  font-weight: 900;
  font-size: 12px;
}

.coverage-bar{
  height: 8px;
  border-radius: 999px;
  background: var(--surface-2);
  overflow: hidden;
}

.coverage-bar span{
  display:block;
  height: 100%;
  width: 0;
  border-radius: 999px;
  background: rgba(76,175,80,0.8);
}

.coverage-item[data-priority="alta"] .coverage-bar span{
  background: linear-gradient(90deg, rgba(244,67,54,0.6), rgba(244,67,54,0.95));
}

.coverage-item[data-priority="media"] .coverage-bar span{
  background: linear-gradient(90deg, rgba(255,193,7,0.6), rgba(255,193,7,0.95));
}

.coverage-item[data-priority="baixa"] .coverage-bar span{
  background: linear-gradient(90deg, rgba(33,150,243,0.6), rgba(33,150,243,0.95));
}

.coverage-meta{
  color: var(--text-muted);
  font-weight: 850;
  font-size: 12px;
}

.coverage-note{
  margin-top: 10px;
  color: var(--text-muted);
  font-weight: 850;
  font-size: 12px;
}

.override-list{
  margin-top: 10px;
  display:grid;
  gap: 10px;
}

.override-item{
  border: 1px solid var(--border);
  background: var(--surface-2);
  border-radius: 16px;
  padding: 10px 12px;
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 12px;
}

.override-title{
  font-weight: 900;
  font-size: 12px;
}

.override-meta{
  color: var(--text-muted);
  font-weight: 850;
  font-size: 12px;
}

.btn-mini{
  height: 34px;
  padding: 0 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text);
  font-weight: 900;
  cursor: pointer;
}

.btn-mini:hover{
  background: var(--surface);
}

@keyframes riseIn{
  from{ opacity: 0; transform: translateY(8px); }
  to{ opacity: 1; transform: translateY(0); }
}

.projection-hero{
  animation: riseIn 0.45s ease both;
}

.projection-grid > .panel{
  animation: riseIn 0.45s ease both;
}

.projection-grid > .panel:nth-of-type(1){ animation-delay: 0.04s; }
.projection-grid > .panel:nth-of-type(2){ animation-delay: 0.08s; }
.projection-grid > .panel:nth-of-type(3){ animation-delay: 0.12s; }
.projection-grid > .panel:nth-of-type(4){ animation-delay: 0.16s; }
.projection-grid > .panel:nth-of-type(5){ animation-delay: 0.2s; }
.projection-grid > .panel:nth-of-type(6){ animation-delay: 0.24s; }

@media (prefers-reduced-motion: reduce){
  .projection-hero,
  .projection-grid > .panel{
    animation: none;
  }
}

.sim-grid{
  margin-top: 10px;
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
}

.sim-card{
  border: 1px solid var(--border);
  background: var(--surface-2);
  border-radius: 16px;
  padding: 12px 14px;
  display:grid;
  gap: 8px;
}

.sim-card h4{
  margin: 0;
  font-size: 14px;
  font-weight: 950;
}

.sim-card p{
  margin: 0;
  color: var(--text-muted);
  font-weight: 850;
  font-size: 12px;
}

.sim-reductions{
  display:grid;
  gap: 8px;
}

.reduction-row{
  display:grid;
  grid-template-columns: 1fr 90px;
  gap: 10px;
  align-items:center;
}

.reduction-row input{
  height: 40px;
  border-radius: 14px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--input-text);
  padding: 0 12px;
  font-weight: 950;
}

.modal{
  position: fixed;
  inset: 0;
  display:none;
  z-index: 9999;
}

.modal.show{
  display:block;
}

.modal-backdrop{
  position:absolute;
  inset:0;
  background: var(--overlay-backdrop);
}

.modal-card{
  position: relative;
  width: min(520px, calc(100% - 24px));
  margin: 6vh auto 0;
  background: var(--overlay);
  border: 1px solid var(--border);
  border-radius: 18px;
  box-shadow: var(--shadow);
  overflow:hidden;
}

.modal-head{
  display:flex;
  justify-content: space-between;
  align-items:center;
  padding: 12px 14px;
  border-bottom: 1px solid var(--divider);
}

.modal-head h3{
  margin:0;
  font-weight: 950;
}

.modal-close{
  width: 38px;
  height: 38px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text);
  cursor:pointer;
  font-size: 20px;
  line-height: 1;
}

.modal-body{
  padding: 14px;
  display:grid;
  gap: 12px;
}

.modal-actions{
  padding: 12px 14px;
  border-top: 1px solid var(--divider);
  display:flex;
  justify-content:flex-end;
  gap: 10px;
}

/* responsivo */
@media (max-width: 1100px){
  .projection-controls{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .kpi-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .sim-grid{ grid-template-columns: 1fr; }
  .projection-grid{ grid-template-columns: repeat(6, minmax(0, 1fr)); }
  .projection-grid > .projection-calendar,
  .projection-grid > .projection-coverage,
  .projection-grid > .projection-risk,
  .projection-grid > .projection-overrides,
  .projection-grid > .projection-simulators{
    grid-column: 1 / -1;
  }
  .calendar-summary{
    grid-template-columns: 1fr;
  }
}

@media (max-width: 900px){
  .projection-hero .panel-head{
    flex-direction: column;
    align-items: flex-start;
  }
  .projection-presets{
    width: 100%;
    justify-content: flex-start;
  }
}
